const ptolemyReproject = require('./main');

describe('ptolemyReproject', () => {
  it('should convert a point', () => {
    const sourceCRS = 4326;
    const toCRS = 32722;
    const pointCoord = [-21.710415, -51.747481];
    expect(ptolemyReproject.point(sourceCRS, toCRS, pointCoord)).toEqual([
      2497833.5546579408,
      3850005.5444479305,
    ]);
  });

  it('should convert multipoints', () => {
    const sourceCRS = 32722;
    const toCRS = 4326;
    const multipointCoords = [
      [499980, 7700020],
      [609780, 7700020],
      [609780, 7590220],
      [499980, 7590220],
      [499980, 7700020],
    ];
    expect(ptolemyReproject.multipoint(sourceCRS, toCRS, multipointCoords)).toEqual([
      [-51.00019218418928, -20.799698659798604],
      [-49.94516839823256, -20.796456414058177],
      [-49.93806796870727, -21.788366104640087],
      [-51.000193478141604, -21.791778063706158],
      [-51.00019218418928, -20.799698659798604],
    ]);
  });

  it('should convert a linestring', () => {
    const sourceCRS = 4326;
    const toCRS = 32723;
    const linestringCoords = [
      [-46.648592948913574, -23.56599329061034],
      [-46.64814233779907, -23.56931715851468],
      [-46.64423704147339, -23.5698088478083],
    ];
    expect(ptolemyReproject.linestring(sourceCRS, toCRS, linestringCoords)).toEqual([
      [331746.3955813152, 7392854.736323394],
      [331796.62778378767, 7392487.18341205],
      [332195.8880409155, 7392437.315244107],
    ]);
  });

  it('should convert a multilinestring', () => {
    const sourceCRS = 4326;
    const toCRS = 32723;
    const multilinestringCoords = [
      [
        [-46.648592948913574, -23.56599329061034],
        [-46.64814233779907, -23.56931715851468],
        [-46.64423704147339, -23.5698088478083],
      ],
      [
        [-46.648592948913574, -23.56599329061034],
        [-46.64814233779907, -23.56931715851468],
        [-46.64423704147339, -23.5698088478083],
      ],
    ];
    expect(ptolemyReproject.multilinestring(sourceCRS, toCRS, multilinestringCoords)).toEqual([
      [
        [331746.3955813152, 7392854.736323394],
        [331796.62778378767, 7392487.18341205],
        [332195.8880409155, 7392437.315244107],
      ],
      [
        [331746.3955813152, 7392854.736323394],
        [331796.62778378767, 7392487.18341205],
        [332195.8880409155, 7392437.315244107],
      ],
    ]);
  });

  it('should convert a polygon', () => {
    const sourceCRS = 4326;
    const toCRS = 32723;
    const polygonCoords = [
      [
        [-46.86492919921875, -23.422298390652134],
        [-46.8511962890625, -23.553287079563514],
        [-46.65550231933594, -23.580979532483962],
        [-46.61155700683594, -23.490327991608794],
        [-46.86492919921875, -23.422298390652134],
      ],
    ];
    expect(ptolemyReproject.polygon(sourceCRS, toCRS, polygonCoords)).toEqual([
      [
        [309455.7514960236, 7408497.705061348],
        [311046.08022366674, 7394009.291934321],
        [331060.28100376145, 7391187.035232978],
        [335432.8277805358, 7401276.713431407],
        [309455.7514960236, 7408497.705061348],
      ],
    ]);
  });

  it('should convert a multipolygon', () => {
    const sourceCRS = 4326;
    const toCRS = 32723;
    const multipolygonCoords = [
      [
        [
          [-46.86492919921875, -23.422298390652134],
          [-46.8511962890625, -23.553287079563514],
          [-46.65550231933594, -23.580979532483962],
          [-46.61155700683594, -23.490327991608794],
          [-46.86492919921875, -23.422298390652134],
        ],
      ],
      [
        [
          [-46.86492919921875, -23.422298390652134],
          [-46.8511962890625, -23.553287079563514],
          [-46.65550231933594, -23.580979532483962],
          [-46.61155700683594, -23.490327991608794],
          [-46.86492919921875, -23.422298390652134],
        ],
      ],
    ];
    expect(ptolemyReproject.multipolygon(sourceCRS, toCRS, multipolygonCoords)).toEqual([
      [
        [
          [309455.7514960236, 7408497.705061348],
          [311046.08022366674, 7394009.291934321],
          [331060.28100376145, 7391187.035232978],
          [335432.8277805358, 7401276.713431407],
          [309455.7514960236, 7408497.705061348],
        ],
      ],
      [
        [
          [309455.7514960236, 7408497.705061348],
          [311046.08022366674, 7394009.291934321],
          [331060.28100376145, 7391187.035232978],
          [335432.8277805358, 7401276.713431407],
          [309455.7514960236, 7408497.705061348],
        ],
      ],
    ]);
  });
});
